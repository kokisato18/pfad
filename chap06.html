<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<link rel="stylesheet" type="text/css" href="css/default.css">
<link rel="stylesheet" type="text/css" href="css/syntax.css">
<link rel="stylesheet" type="text/css" href="css/style.css">
<script type="text/javascript" src="./js/jquery-latest.js"></script>
<script type="text/javascript" src="./js/jquery.tablesorter.min.js"></script>
<script type="text/javascript">
$(function() {
  $("#errata1").tablesorter({headers: {2: {sorter: false}}});
  $("#errata2").tablesorter({headers: {2: {sorter: false}}});
  $("#errata3").tablesorter({headers: {2: {sorter: false}}});
});
</script>
<title>06. 小町算</title>
</head>
<body>
<div class="structure" id="header">
  <h1><a href="http://github.com/sampou-org/pfad/">PFAD：</a>06. 小町算</h1>
</div>
<div class="structure" id="container">
  <div id="primary-contents">
    <div id="box">
      <h3 id="小さな理論">小さな理論</h3>
<h4 id="つの運算を合わせて以下に到達する">2つの運算を合わせて、以下に到達する</h4>
<pre><code>map (fork (id,value)) . extend' x
= { 2つの運算を合わせて }
filter (ok . snd) . zip . cross (extend x, modify x) . unzip . map (fork (id,value))
= { expand x = filter (ok . snd) . zip . cross (extend x, modify x) . unzip とおく }
expand x . map (fork (id,value))</code></pre>
<p>これで31ページ上の「以下を満たす expand を求めなければならない」の</p>
<pre><code>map (fork (id,value)) . extend' x = expand x . map (fork (id,value))</code></pre>
<p>が成り立っていることが確認できた。 このときそのすぐ下に書いてあるとおり</p>
<pre><code>candidates = foldr expand []</code></pre>
<p>である。</p>
<p>一方、29ページ中の</p>
<pre><code>solutions = filter (good . value) . candidates</code></pre>
<p>は31ページの「新しい版の candidates は、候補とそれらの値との対からなるリストを返す」の変更に伴って</p>
<pre><code>solutions = map fst . filter (good . snd) . candidates</code></pre>
<p>これに上記の candidates = foldr expand [] を使うと</p>
<pre><code>solutions = map fst . filter (good . snd) . foldr expand []</code></pre>
<h3 id="小町算">小町算</h3>
<h4 id="modify-x-kfte-10kkxfte-10xfte10x1fte"><code>modify x (k,f,t,e) = [(10*k,k*x+f,t,e), (10,x,f*t,e),(10,x,1,f*t+e)]</code></h4>
<pre><code>k: 数字を数式の一番左に来ている数の先頭桁として付け加えるときの桁を表す数(10の累乗）
f: 数式の一番左に来ている数
t: 数式の一番左に来ている数の右に掛け算されている数（掛け算されていないときは 1）
e: 数式の一番左に来ている掛け算の項の右に足し算されている数（足し算されていないときは 0）</code></pre>
<p>例えば数式 <code>45*6+7*8+9</code> に対応する (k,f,t,e) は (100,45,6,7*8+9)。</p>
<p>この数式の左に 3 をおいた数式には次のような三通りがある。</p>
<pre><code>345*6+7*8+9
3*45*6+7*8+9
3+45*6+7*8+9</code></pre>
<p>それぞれの数式に対応する (k,f,t,e) は以下のようになる。</p>
<pre><code>345*6+7*8+9 =&gt; (1000,345,6,7*8+9)
3*45*6+7*8+9 =&gt; (10,3,45*6,7*8+9)
3+45*6+7*8+9 =&gt; (10,3,1,45*6+7*8+9)</code></pre>
<p>これがそれぞれ</p>
<pre><code>(10*k, k*x + f, t, e)
(10, x, f*t, e)
(10, x, 1, f*t + e)</code></pre>
<p>に対応している。</p>
    </div>
  </div>
  <div id="secondary-contents">
    <div id="navigation">
      Last update: 2015-05-13 <br>
      <a href="index.html">HOME</a><br>
      <a href="errata.html">正誤表</a>(2015-01-17)<br><br>
      解説などすこしずつ追加中
      <ol>
       <li><a href="chap01.html">最小自由数</a></li>
       <li><a href="chap02.html">上位者問題</a>
       <li><a href="chap03.html">鞍型探索の改良</a>
       <li><a href="chap04.html">選択問題</a>
       <li><a href="chap05.html">組和の整列</a>
       <li><a href="chap06.html">小町算</a>
       <li><a href="chap07.html">最小高さ木の構築</a>
       <li><a href="chap08.html">分解の貪欲アルゴリズム</a>
       <li><a href="chap09.html">セレブを探せ</a>
       <li><a href="chap10.html">重複の除去</a>
       <li><a href="chap11.html">最大非連続部分列和</a>
       <li><a href="chap12.html">接尾辞ランキング</a>
       <li><a href="chap13.html">Burrows-Wheeler変換</a>
       <li><a href="chap14.html">最後の接尾辞</a>
       <li><a href="chap15.html">すべての共通接頭辞</a>
       <li><a href="chap16.html">Boyer-Mooreアルゴリズム</a>
       <li><a href="chap17.html">Knuth-Morris-Prattアルゴリズム</a>
       <li><a href="chap18.html">プランニングで解く「ラッシュアワー」問題</a>
       <li><a href="chap19.html">簡単な数独ソルバー</a>
       <li><a href="chap20.html">「カウントダウン」問題</a>
       <li><a href="chap21.html">ハイロモルフィズムとネクサス</a>
       <li><a href="chap22.html">行列式の3つの計算法</a>
       <li><a href="chap23.html">凸包の内側</a>
       <li><a href="chap24.html">有理算術符号</a>
       <li><a href="chap25.html">整数算術符号</a>
       <li><a href="chap26.html">Schorr-Waiteアルゴリズム</a>
       <li><a href="chap27.html">順挿入</a>
       <li><a href="chap28.html">ループレス関数アルゴリズム</a>
       <li><a href="chap29.html">Johnson-Trotterアルゴリズム</a>
       <li><a href="chap30.html">だれでもわかる，クモの巣かけ</a>
      </ol>
    </div>
  </div>
</div>
<div class="structure" id="footer">
  &copy; 2014 Nobuo Yamashita all rights reserved.
</div>
</body>
</html>